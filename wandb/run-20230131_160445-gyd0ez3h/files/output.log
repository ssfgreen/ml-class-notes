
6.19.2
6.19.2
(60000, 28, 28) 28 28
(60000, 28, 28) 28 28
(60000, 10) (10000, 10) 10 range(0, 10)
Metal device set to: Apple M1 Pro
systemMemory: 32.00 GB
maxCacheSize: 10.67 GB
2023-01-31 16:09:44.294465: I tensorflow/core/common_runtime/pluggable_device/pluggable_device_factory.cc:306] Could not identify NUMA node of platform GPU ID 0, defaulting to 0. Your kernel may not have been built with NUMA support.
2023-01-31 16:09:44.294858: I tensorflow/core/common_runtime/pluggable_device/pluggable_device_factory.cc:272] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 0 MB memory) -> physical PluggableDevice (device: 0, name: METAL, pci bus id: <undefined>)
[34m[1mwandb[39m[22m: [33mWARNING[39m The save_model argument by default saves the model in the HDF5 format that cannot save custom objects like subclassed models and custom layers. This behavior will be deprecated in a future release in favor of the SavedModel format. Meanwhile, the HDF5 model is saved as W&B files and the SavedModel as W&B Artifacts.
[34m[1mwandb[39m[22m: [33mWARNING[39m The data_type argument of wandb.keras.WandbCallback is deprecated and will be removed in a future release. Please use input_type instead.
[34m[1mwandb[39m[22m: [33mWARNING[39m Setting input_type = data_type.
2023-01-31 16:16:04.681384: W tensorflow/tsl/platform/profile_utils/cpu_utils.cc:128] Failed to get CPU frequency: 0 Hz
Epoch 1/10
   1/1875 [..............................] - ETA: 10:44 - loss: 12712.0332 - accuracy: 0.0625WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0046s vs `on_train_batch_end` time: 0.0047s). Check your callbacks.
  99/1875 [>.............................] - ETA: 8s - loss: 3169.3169 - accuracy: 0.1105




1750/1875 [===========================>..] - ETA: 0s - loss: 395.7404 - accuracy: 0.1091

2/2 [==============================] - 0s 7ms/step0s - loss: 372.0154 - accuracy: 0.1095
2023-01-31 16:16:15.420998: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:114] Plugin optimizer for device_type GPU is enabled.
[34m[1mwandb[39m[22m: Adding directory to artifact (/Users/samgreen/Development/ml/ml-class/notes/wandb/run-20230131_160445-gyd0ez3h/files/model-best)... Done. 0.0s
INFO:tensorflow:Assets written to: /Users/samgreen/Development/ml/ml-class/notes/wandb/run-20230131_160445-gyd0ez3h/files/model-best/assets
1875/1875 [==============================] - 12s 6ms/step - loss: 371.0834 - accuracy: 0.1096 - val_loss: 22.9878 - val_accuracy: 0.1138
Epoch 2/10



2/2 [==============================] - 0s 3ms/step0s - loss: 7.4085 - accuracy: 0.1579
INFO:tensorflow:Assets written to: /Users/samgreen/Development/ml/ml-class/notes/wandb/run-20230131_160445-gyd0ez3h/files/model-best/assets
[34m[1mwandb[39m[22m: Adding directory to artifact (/Users/samgreen/Development/ml/ml-class/notes/wandb/run-20230131_160445-gyd0ez3h/files/model-best)... Done. 0.0s
1875/1875 [==============================] - 11s 6ms/step - loss: 7.3746 - accuracy: 0.1582 - val_loss: 1.6417 - val_accuracy: 0.2950
Epoch 3/10


2/2 [==============================] - 0s 3ms/step0s - loss: 4.9899 - accuracy: 0.1769
1875/1875 [==============================] - 10s 5ms/step - loss: 4.9885 - accuracy: 0.1769 - val_loss: 7.1577 - val_accuracy: 0.1248
Epoch 4/10




2/2 [==============================] - 0s 3ms/step0s - loss: 6.5454 - accuracy: 0.1551
1875/1875 [==============================] - 10s 5ms/step - loss: 6.5462 - accuracy: 0.1551 - val_loss: 6.0938 - val_accuracy: 0.1136
Epoch 5/10




2/2 [==============================] - 0s 3ms/step0s - loss: 6.9115 - accuracy: 0.1574
1875/1875 [==============================] - 10s 5ms/step - loss: 6.9116 - accuracy: 0.1574 - val_loss: 7.7032 - val_accuracy: 0.1328
Epoch 6/10




2/2 [==============================] - 0s 3ms/step0s - loss: 7.0216 - accuracy: 0.1506
1875/1875 [==============================] - 10s 5ms/step - loss: 7.0202 - accuracy: 0.1506 - val_loss: 5.8521 - val_accuracy: 0.1476
Epoch 7/10




2/2 [==============================] - 0s 3ms/step0s - loss: 6.1135 - accuracy: 0.1569
1875/1875 [==============================] - 11s 6ms/step - loss: 6.1139 - accuracy: 0.1569 - val_loss: 6.9191 - val_accuracy: 0.1350
Epoch 8/10





2/2 [==============================] - 0s 4ms/step0s - loss: 6.9939 - accuracy: 0.1526
1875/1875 [==============================] - 10s 5ms/step - loss: 6.9814 - accuracy: 0.1527 - val_loss: 2.8331 - val_accuracy: 0.2257
Epoch 9/10




2/2 [==============================] - 0s 2ms/step0s - loss: 6.7550 - accuracy: 0.1555
1875/1875 [==============================] - 10s 5ms/step - loss: 6.7539 - accuracy: 0.1555 - val_loss: 4.9119 - val_accuracy: 0.1098
Epoch 10/10




2/2 [==============================] - 0s 3ms/step0s - loss: 6.4552 - accuracy: 0.1561
1875/1875 [==============================] - 10s 5ms/step - loss: 6.4658 - accuracy: 0.1561 - val_loss: 6.6945 - val_accuracy: 0.2502
2023-01-31 16:21:25.647026: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:114] Plugin optimizer for device_type GPU is enabled.
Epoch 1/10
2/2 [==============================] - 0s 3ms/steposs: 8.5120 - accuracy: 0.4000
1/1 [==============================] - 2s 2s/step - loss: 8.5120 - accuracy: 0.4000 - val_loss: 8.4952 - val_accuracy: 0.1613
Epoch 2/10
2/2 [==============================] - 0s 3ms/steposs: 7.7750 - accuracy: 0.3000
1/1 [==============================] - 1s 1s/step - loss: 7.7750 - accuracy: 0.3000 - val_loss: 8.8912 - val_accuracy: 0.1630
Epoch 3/10
2/2 [==============================] - 0s 3ms/steposs: 2.4699 - accuracy: 0.3500
1/1 [==============================] - 1s 1s/step - loss: 2.4699 - accuracy: 0.3500 - val_loss: 13.4071 - val_accuracy: 0.1623
Epoch 4/10
2/2 [==============================] - 0s 3ms/steposs: 5.1161 - accuracy: 0.2000
1/1 [==============================] - 1s 1s/step - loss: 5.1161 - accuracy: 0.2000 - val_loss: 10.4378 - val_accuracy: 0.1860
Epoch 5/10
2/2 [==============================] - 0s 2ms/steposs: 3.7001 - accuracy: 0.3000
1/1 [==============================] - 1s 1s/step - loss: 3.7001 - accuracy: 0.3000 - val_loss: 10.1699 - val_accuracy: 0.1350
Epoch 6/10
2/2 [==============================] - 0s 3ms/steposs: 4.6578 - accuracy: 0.3000
1/1 [==============================] - 1s 1s/step - loss: 4.6578 - accuracy: 0.3000 - val_loss: 11.6228 - val_accuracy: 0.1056
Epoch 7/10
2/2 [==============================] - 0s 2ms/steposs: 5.1162 - accuracy: 0.1500
1/1 [==============================] - 1s 1s/step - loss: 5.1162 - accuracy: 0.1500 - val_loss: 11.6293 - val_accuracy: 0.1035
Epoch 8/10
2/2 [==============================] - 0s 3ms/steposs: 2.6190 - accuracy: 0.3000
1/1 [==============================] - 2s 2s/step - loss: 2.6190 - accuracy: 0.3000 - val_loss: 14.2668 - val_accuracy: 0.1500
Epoch 9/10
2/2 [==============================] - 0s 3ms/steposs: 3.3071 - accuracy: 0.2000
1/1 [==============================] - 1s 1s/step - loss: 3.3071 - accuracy: 0.2000 - val_loss: 13.1973 - val_accuracy: 0.1583
Epoch 10/10
2/2 [==============================] - 0s 3ms/steposs: 2.0075 - accuracy: 0.3500
1/1 [==============================] - 1s 1s/step - loss: 2.0075 - accuracy: 0.3500 - val_loss: 12.9769 - val_accuracy: 0.1482
1/1 [==============================] - 0s 17ms/step
[[ 2.7356758   2.979292   -1.2059728   1.9351178   0.16843529  2.23338
   3.5187204  -3.477065   -0.7936001   0.05216171]
 [ 5.1280546   3.05572     2.148266   -0.07108825  1.5342474   5.3271804
   5.721227   -8.347486   -5.7208853   2.0231433 ]
 [ 0.96043944 -0.17473808 -0.3349041   0.41346583  1.1684804  -1.4520338
   0.89313495 -0.1448921  -0.8175715  -0.98033804]
 [ 2.2265787  -0.00999057 -1.1833718   3.2120416  -1.5608323   0.7580197
   1.9693525  -1.0892428  -1.4163203   0.3269245 ]
 [ 0.50949883 -1.9311041   1.3046154  -0.43319622  2.0384398  -0.23658851
   0.3867456   0.02760056  0.8450306  -2.5070944 ]
 [ 1.9296781   0.0577106  -1.3540739   1.5984496   1.5738907  -1.5520787
   0.81917894 -0.4518146  -1.2901573  -1.0956548 ]
 [-1.321011   -2.2049115   3.3337781  -4.5709357   4.1155553  -0.15296635
  -0.4682484   0.16397166  1.612479   -4.78374   ]
 [ 0.75867164 -5.006551   -1.9960364   0.21911436  6.2558765  -5.8929033
   0.5668373   1.6543177   0.4135548  -0.3064365 ]
 [ 1.6184224  -1.3365258  -0.42550477 -3.5246596   2.4093308  -2.9013255
  -1.9544998   0.92090136 -0.7534942   2.0016155 ]
 [ 0.8325551  -0.08691444 -1.283137    0.81752366  3.945605   -1.9837998
   1.8090873  -1.5262308  -0.81420374 -3.2232225 ]]
Epoch 1/10
   1/1875 [..............................] - ETA: 8:46 - loss: 0.5210 - accuracy: 0.0938WARNING:tensorflow:Callback method `on_train_batch_end` is slow compared to the batch time (batch time: 0.0045s vs `on_train_batch_end` time: 0.0046s). Check your callbacks.
 123/1875 [>.............................] - ETA: 9s - loss: 0.1322 - accuracy: 0.1189




1869/1875 [============================>.] - ETA: 0s - loss: 0.0867 - accuracy: 0.3007
2/2 [==============================] - 0s 6ms/step0s - loss: 0.0867 - accuracy: 0.3007
INFO:tensorflow:Assets written to: /Users/samgreen/Development/ml/ml-class/notes/wandb/run-20230131_160445-gyd0ez3h/files/model-best/assets
2023-01-31 16:29:42.644575: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:114] Plugin optimizer for device_type GPU is enabled.
[34m[1mwandb[39m[22m: Adding directory to artifact (/Users/samgreen/Development/ml/ml-class/notes/wandb/run-20230131_160445-gyd0ez3h/files/model-best)... Done. 0.0s
1875/1875 [==============================] - 11s 6ms/step - loss: 0.0867 - accuracy: 0.3010 - val_loss: 0.0789 - val_accuracy: 0.3468
Epoch 2/10
1138/1875 [=================>............] - ETA: 3s - loss: 0.0789 - accuracy: 0.3540
1548/1875 [=======================>......] - ETA: 1s - loss: 0.0784 - accuracy: 0.3577
1868/1875 [============================>.] - ETA: 0s - loss: 0.0780 - accuracy: 0.3633
1868/1875 [============================>.] - ETA: 0s - loss: 0.0780 - accuracy: 0.3633
INFO:tensorflow:Assets written to: /Users/samgreen/Development/ml/ml-class/notes/wandb/run-20230131_160445-gyd0ez3h/files/model-best/assets
 580/1875 [========>.....................] - ETA: 5s - loss: 0.0744 - accuracy: 0.4027 3636 - val_loss: 0.0756 - val_accuracy: 0.4021assets
1018/1875 [===============>..............] - ETA: 3s - loss: 0.0743 - accuracy: 0.4103 3636 - val_loss: 0.0756 - val_accuracy: 0.4021assets
1459/1875 [======================>.......] - ETA: 1s - loss: 0.0737 - accuracy: 0.4160 3636 - val_loss: 0.0756 - val_accuracy: 0.4021assets
1864/1875 [============================>.] - ETA: 0s - loss: 0.0733 - accuracy: 0.4186 3636 - val_loss: 0.0756 - val_accuracy: 0.4021assets
INFO:tensorflow:Assets written to: /Users/samgreen/Development/ml/ml-class/notes/wandb/run-20230131_160445-gyd0ez3h/files/model-best/assets
INFO:tensorflow:Assets written to: /Users/samgreen/Development/ml/ml-class/notes/wandb/run-20230131_160445-gyd0ez3h/files/model-best/assets
 861/1875 [============>.................] - ETA: 4s - loss: 0.0715 - accuracy: 0.4285 4183 - val_loss: 0.0709 - val_accuracy: 0.4271assets
1280/1875 [===================>..........] - ETA: 2s - loss: 0.0710 - accuracy: 0.4320 4183 - val_loss: 0.0709 - val_accuracy: 0.4271assets
1697/1875 [==========================>...] - ETA: 0s - loss: 0.0710 - accuracy: 0.4337 4183 - val_loss: 0.0709 - val_accuracy: 0.4271assets
1873/1875 [============================>.] - ETA: 0s - loss: 0.0710 - accuracy: 0.4339 4183 - val_loss: 0.0709 - val_accuracy: 0.4271assets
1873/1875 [============================>.] - ETA: 0s - loss: 0.0710 - accuracy: 0.4339 4183 - val_loss: 0.0709 - val_accuracy: 0.4271assets
INFO:tensorflow:Assets written to: /Users/samgreen/Development/ml/ml-class/notes/wandb/run-20230131_160445-gyd0ez3h/files/model-best/assets
 679/1875 [=========>....................] - ETA: 5s - loss: 0.0701 - accuracy: 0.4427 4338 - val_loss: 0.0692 - val_accuracy: 0.4431assets
1115/1875 [================>.............] - ETA: 3s - loss: 0.0707 - accuracy: 0.4380 4338 - val_loss: 0.0692 - val_accuracy: 0.4431assets
1542/1875 [=======================>......] - ETA: 1s - loss: 0.0705 - accuracy: 0.4386 4338 - val_loss: 0.0692 - val_accuracy: 0.4431assets
1870/1875 [============================>.] - ETA: 0s - loss: 0.0703 - accuracy: 0.4385 4338 - val_loss: 0.0692 - val_accuracy: 0.4431assets
1870/1875 [============================>.] - ETA: 0s - loss: 0.0703 - accuracy: 0.4385 4338 - val_loss: 0.0692 - val_accuracy: 0.4431assets
INFO:tensorflow:Assets written to: /Users/samgreen/Development/ml/ml-class/notes/wandb/run-20230131_160445-gyd0ez3h/files/model-best/assets
 980/1875 [==============>...............] - ETA: 4s - loss: 0.0698 - accuracy: 0.4380 4385 - val_loss: 0.0692 - val_accuracy: 0.4377assets
1428/1875 [=====================>........] - ETA: 2s - loss: 0.0699 - accuracy: 0.4418 4385 - val_loss: 0.0692 - val_accuracy: 0.4377assets
1850/1875 [============================>.] - ETA: 0s - loss: 0.0698 - accuracy: 0.4423 4385 - val_loss: 0.0692 - val_accuracy: 0.4377assets
INFO:tensorflow:Assets written to: /Users/samgreen/Development/ml/ml-class/notes/wandb/run-20230131_160445-gyd0ez3h/files/model-best/assets
INFO:tensorflow:Assets written to: /Users/samgreen/Development/ml/ml-class/notes/wandb/run-20230131_160445-gyd0ez3h/files/model-best/assets
 876/1875 [=============>................] - ETA: 4s - loss: 0.0689 - accuracy: 0.4463 4426 - val_loss: 0.0690 - val_accuracy: 0.4415assets
1319/1875 [====================>.........] - ETA: 2s - loss: 0.0691 - accuracy: 0.4444 4426 - val_loss: 0.0690 - val_accuracy: 0.4415assets
1748/1875 [==========================>...] - ETA: 0s - loss: 0.0692 - accuracy: 0.4439 4426 - val_loss: 0.0690 - val_accuracy: 0.4415assets
2/2 [==============================] - 0s 3ms/step0s - loss: 0.0692 - accuracy: 0.4430 4426 - val_loss: 0.0690 - val_accuracy: 0.4415assets
2/2 [==============================] - 0s 3ms/step0s - loss: 0.0692 - accuracy: 0.4430 4426 - val_loss: 0.0690 - val_accuracy: 0.4415assets
INFO:tensorflow:Assets written to: /Users/samgreen/Development/ml/ml-class/notes/wandb/run-20230131_160445-gyd0ez3h/files/model-best/assets
 812/1875 [===========>..................] - ETA: 4s - loss: 0.0694 - accuracy: 0.4419 4429 - val_loss: 0.0682 - val_accuracy: 0.4455assets
1252/1875 [===================>..........] - ETA: 2s - loss: 0.0692 - accuracy: 0.4443 4429 - val_loss: 0.0682 - val_accuracy: 0.4455assets
1695/1875 [==========================>...] - ETA: 0s - loss: 0.0690 - accuracy: 0.4473 4429 - val_loss: 0.0682 - val_accuracy: 0.4455assets
2/2 [==============================] - 0s 3ms/step0s - loss: 0.0690 - accuracy: 0.4478 4429 - val_loss: 0.0682 - val_accuracy: 0.4455assets
2/2 [==============================] - 0s 3ms/step0s - loss: 0.0690 - accuracy: 0.4478 4429 - val_loss: 0.0682 - val_accuracy: 0.4455assets
INFO:tensorflow:Assets written to: /Users/samgreen/Development/ml/ml-class/notes/wandb/run-20230131_160445-gyd0ez3h/files/model-best/assets
 767/1875 [===========>..................] - ETA: 5s - loss: 0.0684 - accuracy: 0.4541 4479 - val_loss: 0.0677 - val_accuracy: 0.4538assets
1158/1875 [=================>............] - ETA: 3s - loss: 0.0690 - accuracy: 0.4504 4479 - val_loss: 0.0677 - val_accuracy: 0.4538assets
1604/1875 [========================>.....] - ETA: 1s - loss: 0.0691 - accuracy: 0.4472 4479 - val_loss: 0.0677 - val_accuracy: 0.4538assets
1871/1875 [============================>.] - ETA: 0s - loss: 0.0691 - accuracy: 0.4466 4479 - val_loss: 0.0677 - val_accuracy: 0.4538assets
 222/1875 [==>...........................] - ETA: 7s - loss: 0.0710 - accuracy: 0.4174 4466 - val_loss: 0.0714 - val_accuracy: 0.4187assets
 689/1875 [==========>...................] - ETA: 5s - loss: 0.0692 - accuracy: 0.4393 4466 - val_loss: 0.0714 - val_accuracy: 0.4187assets
1134/1875 [=================>............] - ETA: 3s - loss: 0.0689 - accuracy: 0.4451 4466 - val_loss: 0.0714 - val_accuracy: 0.4187assets
1584/1875 [========================>.....] - ETA: 1s - loss: 0.0689 - accuracy: 0.4427 4466 - val_loss: 0.0714 - val_accuracy: 0.4187assets
1872/1875 [============================>.] - ETA: 0s - loss: 0.0690 - accuracy: 0.4437 4466 - val_loss: 0.0714 - val_accuracy: 0.4187assets
1875/1875 [==============================] - 10s 5ms/step - loss: 0.0690 - accuracy: 0.4437 - val_loss: 0.0679 - val_accuracy: 0.4570assets
 [0.00000e+00 1.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00- accuracy: 0.4437 - val_loss: 0.0679 - val_accuracy: 0.4570assets
 [0.00000e+00 1.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00- accuracy: 0.4437 - val_loss: 0.0679 - val_accuracy: 0.4570assets
  0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
 [0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 1.00000e+00 0.00000e+00
  0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
 [0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00
  0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
 [0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 1.02909e-36 0.00000e+00
  0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00]
 [0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00 0.00000e+00
